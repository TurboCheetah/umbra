var dbits,canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary);function BigInteger(t,e,o){null!=t&&("number"==typeof t?this.fromNumber(t,e,o):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function nbi(){return new BigInteger(null)}function am1(t,e,o,r,p,d){for(;0<=--d;){var s=e*this[t++]+o[r]+p;p=Math.floor(s/67108864),o[r++]=67108863&s}return p}function am2(t,e,o,r,p,d){for(var s=32767&e,a=e>>15;0<=--d;){var u=32767&this[t],y=this[t++]>>15,h=a*u+y*s;u=s*u+((32767&h)<<15)+o[r]+(1073741823&p),p=(u>>>30)+(h>>>15)+a*y+(p>>>30),o[r++]=1073741823&u}return p}function am3(t,e,o,r,p,d){for(var s=16383&e,a=e>>14;0<=--d;){var u=16383&this[t],y=this[t++]>>14,h=a*u+y*s;u=s*u+((16383&h)<<14)+o[r]+p,p=(u>>28)+(h>>14)+a*y,o[r++]=268435455&u}return p}j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,52),BigInteger.prototype.F1=52-dbits,BigInteger.prototype.F2=2*dbits-52;var rr,vv,BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=[];for(rr=48,vv=0;9>=vv;++vv)BI_RC[rr++]=vv;for(rr=97,vv=10;36>vv;++vv)BI_RC[rr++]=vv;for(rr=65,vv=10;36>vv;++vv)BI_RC[rr++]=vv;function int2char(t){return BI_RM.charAt(t)}function intAt(t,e){var o=BI_RC[t.charCodeAt(e)];return null==o?-1:o}function bnpCopyTo(t){for(var e=this.t-1;0<=e;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function bnpFromInt(t){this.t=1,this.s=0>t?-1:0,0<t?this[0]=t:-1>t?this[0]=t+DV:this.t=0}function nbv(t){var e=nbi();return e.fromInt(t),e}function bnpFromString(t,e){var o;if(16==e)o=4;else if(8==e)o=3;else if(256==e)o=8;else if(2==e)o=1;else if(32==e)o=5;else if(4==e)o=2;else return void this.fromRadix(t,e);this.t=0,this.s=0;for(var r=t.length,n=!1,p=0;0<=--r;){var d=8==o?255&t[r]:intAt(t,r);if(0>d){"-"==t.charAt(r)&&(n=!0);continue}n=!1,0==p?this[this.t++]=d:p+o>this.DB?(this[this.t-1]|=(d&(1<<this.DB-p)-1)<<p,this[this.t++]=d>>this.DB-p):this[this.t-1]|=d<<p,p+=o,p>=this.DB&&(p-=this.DB)}8==o&&0!=(128&t[0])&&(this.s=-1,0<p&&(this[this.t-1]|=(1<<this.DB-p)-1<<p)),this.clamp(),n&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var t=this.s&this.DM;0<this.t&&this[this.t-1]==t;)--this.t}function bnToString(t){if(0>this.s)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else if(64==t)e=6;else if(4==t)e=2;else return this.toRadix(t);var o,n=(1<<e)-1,s=!1,a="",l=this.t,h=this.DB-l*this.DB%e;if(0<l--)for(h<this.DB&&0<(o=this[l]>>h)&&(s=!0,a=int2char(o));0<=l;)h<e?(o=(this[l]&(1<<h)-1)<<e-h,o|=this[--l]>>(h+=this.DB-e)):(o=this[l]>>(h-=e)&n,0>=h&&(h+=this.DB,--l)),0<o&&(s=!0),s&&(a+=int2char(o));return s?a:"0"}function bnNegate(){var t=nbi();return BigInteger.ZERO.subTo(this,t),t}function bnAbs(){return 0>this.s?this.negate():this}function bnCompareTo(t){var e=this.s-t.s;if(0!=e)return e;var o=this.t;if(e=o-t.t,0!=e)return e;for(;0<=--o;)if(0!=(e=this[o]-t[o]))return e;return 0}function nbits(e){var o,n=1;return 0!=(o=e>>>16)&&(e=o,n+=16),0!=(o=e>>8)&&(e=o,n+=8),0!=(o=e>>4)&&(e=o,n+=4),0!=(o=e>>2)&&(e=o,n+=2),0!=(o=e>>1)&&(e=o,n+=1),n}function bnBitLength(){return 0>=this.t?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(t,e){var o;for(o=this.t-1;0<=o;--o)e[o+t]=this[o];for(o=t-1;0<=o;--o)e[o]=0;e.t=this.t+t,e.s=this.s}function bnpDRShiftTo(t,e){for(var o=t;o<this.t;++o)e[o-t]=this[o];e.t=Math.max(this.t-t,0),e.s=this.s}function bnpLShiftTo(t,e){var o,r=t%this.DB,n=this.DB-r,p=Math.floor(t/this.DB),d=this.s<<r&this.DM;for(o=this.t-1;0<=o;--o)e[o+p+1]=this[o]>>n|d,d=(this[o]&(1<<n)-1)<<r;for(o=p-1;0<=o;--o)e[o]=0;e[p]=d,e.t=this.t+p+1,e.s=this.s,e.clamp()}function bnpRShiftTo(t,e){e.s=this.s;var o=Math.floor(t/this.DB);if(o>=this.t)return void(e.t=0);var r=t%this.DB,n=this.DB-r,p=(1<<r)-1;e[0]=this[o]>>r;for(var d=o+1;d<this.t;++d)e[d-o-1]|=(this[d]&p)<<n,e[d-o]=this[d]>>r;0<r&&(e[this.t-o-1]|=(this.s&p)<<n),e.t=this.t-o,e.clamp()}function bnpSubTo(t,e){for(var o=0,r=0,n=Math.min(t.t,this.t);o<n;)r+=this[o]-t[o],e[o++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;o<this.t;)r+=this[o],e[o++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;o<t.t;)r-=t[o],e[o++]=r&this.DM,r>>=this.DB;r-=t.s}e.s=0>r?-1:0,-1>r?e[o++]=this.DV+r:0<r&&(e[o++]=r),e.t=o,e.clamp()}function bnpMultiplyTo(t,e){var o=this.abs(),r=t.abs(),n=o.t;for(e.t=n+r.t;0<=--n;)e[n]=0;for(n=0;n<r.t;++n)e[n+o.t]=o.am(0,r[n],e,n,0,o.t);e.s=0,e.clamp(),this.s!=t.s&&BigInteger.ZERO.subTo(e,e)}function bnpSquareTo(t){for(var e=this.abs(),o=t.t=2*e.t;0<=--o;)t[o]=0;for(o=0;o<e.t-1;++o){var r=e.am(o,e[o],t,2*o,0,1);(t[o+e.t]+=e.am(o+1,2*e[o],t,2*o+1,r,e.t-o-1))>=e.DV&&(t[o+e.t]-=e.DV,t[o+e.t+1]=1)}0<t.t&&(t[t.t-1]+=e.am(o,e[o],t,2*o,0,1)),t.s=0,t.clamp()}function bnpDivRemTo(o,n,p){var d=o.abs();if(!(0>=d.t)){var s=this.abs();if(s.t<d.t)return null!=n&&n.fromInt(0),void(null!=p&&this.copyTo(p));null==p&&(p=nbi());var a=nbi(),m=this.s,l=o.s,h=this.DB-nbits(d[d.t-1]);0<h?(d.lShiftTo(h,a),s.lShiftTo(h,p)):(d.copyTo(a),s.copyTo(p));var c=a.t,u=a[c-1];if(0!=u){var y=u*(1<<this.F1)+(1<c?a[c-2]>>this.F2:0),g=this.FV/y,f=(1<<this.F1)/y,b=1<<this.F2,e=p.t,T=e-c,S=null==n?nbi():n;for(a.dlShiftTo(T,S),0<=p.compareTo(S)&&(p[p.t++]=1,p.subTo(S,p)),BigInteger.ONE.dlShiftTo(c,S),S.subTo(a,a);a.t<c;)a[a.t++]=0;for(;0<=--T;){var t=p[--e]==u?this.DM:Math.floor(p[e]*g+(p[e-1]+b)*f);if((p[e]+=a.am(0,t,p,T,0,c))<t)for(a.dlShiftTo(T,S),p.subTo(S,p);p[e]<--t;)p.subTo(S,p)}null!=n&&(p.drShiftTo(c,n),m!=l&&BigInteger.ZERO.subTo(n,n)),p.t=c,p.clamp(),0<h&&p.rShiftTo(h,p),0>m&&BigInteger.ZERO.subTo(p,p)}}}function bnMod(t){var e=nbi();return this.abs().divRemTo(t,null,e),0>this.s&&0<e.compareTo(BigInteger.ZERO)&&t.subTo(e,e),e}function Classic(t){this.m=t}function cConvert(t){return 0>t.s||0<=t.compareTo(this.m)?t.mod(this.m):t}function cRevert(t){return t}function cReduce(t){t.divRemTo(this.m,null,t)}function cMulTo(t,e,o){t.multiplyTo(e,o),this.reduce(o)}function cSqrTo(t,e){t.squareTo(e),this.reduce(e)}Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(1>this.t)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return e=15&e*(2-(15&t)*e),e=255&e*(2-(255&t)*e),e=65535&e*(2-(65535&(65535&t)*e)),e=e*(2-t*e%this.DV)%this.DV,0<e?this.DV-e:-e}function Montgomery(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function montConvert(t){var e=nbi();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),0>t.s&&0<e.compareTo(BigInteger.ZERO)&&this.m.subTo(e,e),e}function montRevert(t){var e=nbi();return t.copyTo(e),this.reduce(e),e}function montReduce(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var o=32767&t[e],r=o*this.mpl+((o*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(o=e+this.m.t,t[o]+=this.m.am(0,r,t,e,0,this.m.t);t[o]>=t.DV;)t[o]-=t.DV,t[++o]++}t.clamp(),t.drShiftTo(this.m.t,t),0<=t.compareTo(this.m)&&t.subTo(this.m,t)}function montSqrTo(t,e){t.squareTo(e),this.reduce(e)}function montMulTo(t,e,o){t.multiplyTo(e,o),this.reduce(o)}Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return 0==(0<this.t?1&this[0]:this.s)}function bnpExp(o,e){if(4294967295<o||1>o)return BigInteger.ONE;var n=nbi(),p=nbi(),d=e.convert(this),s=nbits(o)-1;for(d.copyTo(n);0<=--s;)if(e.sqrTo(n,p),0<(o&1<<s))e.mulTo(p,d,n);else{var a=n;n=p,p=a}return e.revert(n)}function bnModPowInt(t,e){var o;return o=256>t||e.isEven()?new Classic(e):new Montgomery(e),this.exp(t,o)}BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1);function bnClone(){var t=nbi();return this.copyTo(t),t}function bnIntValue(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function bnSigNum(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1}function bnpToRadix(t){if(null==t&&(t=10),0==this.signum()||2>t||36<t)return"0";var e=this.chunkSize(t),o=Math.pow(t,e),n=nbv(o),p=nbi(),d=nbi(),s="";for(this.divRemTo(n,p,d);0<p.signum();)s=(o+d.intValue()).toString(t).substr(1)+s,p.divRemTo(n,p,d);return d.intValue().toString(t)+s}function bnpFromRadix(t,e){this.fromInt(0),null==e&&(e=10);for(var o,r=this.chunkSize(e),n=Math.pow(e,r),p=!1,d=0,s=0,a=0;a<t.length;++a){if(o=intAt(t,a),0>o){"-"==t.charAt(a)&&0==this.signum()&&(p=!0);continue}s=e*s+o,++d>=r&&(this.dMultiply(n),this.dAddOffset(s,0),d=0,s=0)}0<d&&(this.dMultiply(Math.pow(e,d)),this.dAddOffset(s,0)),p&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(e,o,r){if(!("number"==typeof o)){var n=[],p=7&e;n.length=(e>>3)+1,o.nextBytes(n),0<p?n[0]&=(1<<p)-1:n[0]=0,this.fromString(n,256)}else if(2>e)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(e-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(o);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(BigInteger.ONE.shiftLeft(e-1),this)}function bnToByteArray(){var t=this.t,e=[];e[0]=this.s;var o,r=this.DB-t*this.DB%8,n=0;if(0<t--)for(r<this.DB&&(o=this[t]>>r)!=(this.s&this.DM)>>r&&(e[n++]=o|this.s<<this.DB-r);0<=t;)8>r?(o=(this[t]&(1<<r)-1)<<8-r,o|=this[--t]>>(r+=this.DB-8)):(o=255&this[t]>>(r-=8),0>=r&&(r+=this.DB,--t)),0!=(128&o)&&(o|=-256),0==n&&(128&this.s)!=(128&o)&&++n,(0<n||o!=this.s)&&(e[n++]=o);return e}function bnEquals(t){return 0==this.compareTo(t)}function bnMin(t){return 0>this.compareTo(t)?this:t}function bnMax(t){return 0<this.compareTo(t)?this:t}function bnpBitwiseTo(t,e,o){var r,n,p=Math.min(t.t,this.t);for(r=0;r<p;++r)o[r]=e(this[r],t[r]);if(t.t<this.t){for(n=t.s&this.DM,r=p;r<this.t;++r)o[r]=e(this[r],n);o.t=this.t}else{for(n=this.s&this.DM,r=p;r<t.t;++r)o[r]=e(n,t[r]);o.t=t.t}o.s=e(this.s,t.s),o.clamp()}function op_and(t,e){return t&e}function bnAnd(t){var e=nbi();return this.bitwiseTo(t,op_and,e),e}function op_or(t,e){return t|e}function bnOr(t){var e=nbi();return this.bitwiseTo(t,op_or,e),e}function op_xor(t,e){return t^e}function bnXor(t){var e=nbi();return this.bitwiseTo(t,op_xor,e),e}function op_andnot(t,e){return t&~e}function bnAndNot(t){var e=nbi();return this.bitwiseTo(t,op_andnot,e),e}function bnNot(){for(var t=nbi(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function bnShiftLeft(t){var e=nbi();return 0>t?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function bnShiftRight(t){var e=nbi();return 0>t?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function lbit(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function bnGetLowestSetBit(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+lbit(this[t]);return 0>this.s?this.t*this.DB:-1}function cbit(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function bnBitCount(){for(var t=0,e=this.s&this.DM,o=0;o<this.t;++o)t+=cbit(this[o]^e);return t}function bnTestBit(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function bnpChangeBit(t,e){var o=BigInteger.ONE.shiftLeft(t);return this.bitwiseTo(o,e,o),o}function bnSetBit(t){return this.changeBit(t,op_or)}function bnClearBit(t){return this.changeBit(t,op_andnot)}function bnFlipBit(t){return this.changeBit(t,op_xor)}function bnpAddTo(t,e){for(var o=0,r=0,n=Math.min(t.t,this.t);o<n;)r+=this[o]+t[o],e[o++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;o<this.t;)r+=this[o],e[o++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;o<t.t;)r+=t[o],e[o++]=r&this.DM,r>>=this.DB;r+=t.s}e.s=0>r?-1:0,0<r?e[o++]=r:-1>r&&(e[o++]=this.DV+r),e.t=o,e.clamp()}function bnAdd(t){var e=nbi();return this.addTo(t,e),e}function bnSubtract(t){var e=nbi();return this.subTo(t,e),e}function bnMultiply(t){var e=nbi();return this.multiplyTo(t,e),e}function bnSquare(){var t=nbi();return this.squareTo(t),t}function bnDivide(t){var e=nbi();return this.divRemTo(t,e,null),e}function bnRemainder(t){var e=nbi();return this.divRemTo(t,null,e),e}function bnDivideAndRemainder(t){var e=nbi(),o=nbi();return this.divRemTo(t,e,o),[e,o]}function bnpDMultiply(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function NullExp(){}function nNop(t){return t}function nMulTo(t,e,o){t.multiplyTo(e,o)}function nSqrTo(t,e){t.squareTo(e)}NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo;function bnPow(t){return this.exp(t,new NullExp)}function bnpMultiplyLowerTo(t,e,o){var r=Math.min(this.t+t.t,e);for(o.s=0,o.t=r;0<r;)o[--r]=0;var n;for(n=o.t-this.t;r<n;++r)o[r+this.t]=this.am(0,t[r],o,r,0,this.t);for(n=Math.min(t.t,e);r<n;++r)this.am(0,t[r],o,r,0,e-r);o.clamp()}function bnpMultiplyUpperTo(t,e,o){--e;var r=o.t=this.t+t.t-e;for(o.s=0;0<=--r;)o[r]=0;for(r=Math.max(e-this.t,0);r<t.t;++r)o[this.t+r-e]=this.am(e-r,t[r],o,0,0,this.t+r-e);o.clamp(),o.drShiftTo(1,o)}function Barrett(t){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function barrettConvert(t){if(0>t.s||t.t>2*this.m.t)return t.mod(this.m);if(0>t.compareTo(this.m))return t;var e=nbi();return t.copyTo(e),this.reduce(e),e}function barrettRevert(t){return t}function barrettReduce(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>t.compareTo(this.r2);)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);0<=t.compareTo(this.m);)t.subTo(this.m,t)}function barrettSqrTo(t,e){t.squareTo(e),this.reduce(e)}function barrettMulTo(t,e,o){t.multiplyTo(e,o),this.reduce(o)}Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(o,e){var p,d,s=o.bitLength(),a=nbv(1);if(0>=s)return a;p=18>s?1:48>s?3:144>s?4:768>s?5:6,d=8>s?new Classic(e):e.isEven()?new Barrett(e):new Montgomery(e);var m=[],l=3,h=p-1,c=(1<<p)-1;if(m[1]=d.convert(this),1<p){var u=nbi();for(d.sqrTo(m[1],u);l<=c;)m[l]=nbi(),d.mulTo(u,m[l-2],m[l]),l+=2}var y,g,f=o.t-1,b=!0,T=nbi();for(s=nbits(o[f])-1;0<=f;){for(s>=h?y=o[f]>>s-h&c:(y=(o[f]&(1<<s+1)-1)<<h-s,0<f&&(y|=o[f-1]>>this.DB+s-h)),l=p;0==(1&y);)y>>=1,--l;if(0>(s-=l)&&(s+=this.DB,--f),b)m[y].copyTo(a),b=!1;else{for(;1<l;)d.sqrTo(a,T),d.sqrTo(T,a),l-=2;0<l?d.sqrTo(a,T):(g=a,a=T,T=g),d.mulTo(T,m[y],a)}for(;0<=f&&0==(o[f]&1<<s);)d.sqrTo(a,T),g=a,a=T,T=g,0>--s&&(s=this.DB-1,--f)}return d.revert(a)}function bnGCD(e){var o=0>this.s?this.negate():this.clone(),r=0>e.s?e.negate():e.clone();if(0>o.compareTo(r)){var n=o;o=r,r=n}var t=o.getLowestSetBit(),p=r.getLowestSetBit();if(0>p)return o;for(t<p&&(p=t),0<p&&(o.rShiftTo(p,o),r.rShiftTo(p,r));0<o.signum();)0<(t=o.getLowestSetBit())&&o.rShiftTo(t,o),0<(t=r.getLowestSetBit())&&r.rShiftTo(t,r),0<=o.compareTo(r)?(o.subTo(r,o),o.rShiftTo(1,o)):(r.subTo(o,r),r.rShiftTo(1,r));return 0<p&&r.lShiftTo(p,r),r}function bnpModInt(t){if(0>=t)return 0;var e=this.DV%t,o=0>this.s?t-1:0;if(0<this.t)if(0==e)o=this[0]%t;else for(var n=this.t-1;0<=n;--n)o=(e*o+this[n])%t;return o}function bnModInverse(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return BigInteger.ZERO;for(var o=t.clone(),r=this.clone(),n=nbv(1),p=nbv(0),s=nbv(0),a=nbv(1);0!=o.signum();){for(;o.isEven();)o.rShiftTo(1,o),e?((!n.isEven()||!p.isEven())&&(n.addTo(this,n),p.subTo(t,p)),n.rShiftTo(1,n)):!p.isEven()&&p.subTo(t,p),p.rShiftTo(1,p);for(;r.isEven();)r.rShiftTo(1,r),e?((!s.isEven()||!a.isEven())&&(s.addTo(this,s),a.subTo(t,a)),s.rShiftTo(1,s)):!a.isEven()&&a.subTo(t,a),a.rShiftTo(1,a);0<=o.compareTo(r)?(o.subTo(r,o),e&&n.subTo(s,n),p.subTo(a,p)):(r.subTo(o,r),e&&s.subTo(n,s),a.subTo(p,a))}if(0!=r.compareTo(BigInteger.ONE))return BigInteger.ZERO;if(0<=a.compareTo(t))return a.subtract(t);if(0>a.signum())a.addTo(t,a);else return a;return 0>a.signum()?a.add(t):a}var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=67108864/lowprimes[lowprimes.length-1];function bnIsProbablePrime(e){var t,o=this.abs();if(1==o.t&&o[0]<=lowprimes[lowprimes.length-1]){for(t=0;t<lowprimes.length;++t)if(o[0]==lowprimes[t])return!0;return!1}if(o.isEven())return!1;for(t=1;t<lowprimes.length;){for(var r=lowprimes[t],n=t+1;n<lowprimes.length&&r<lplim;)r*=lowprimes[n++];for(r=o.modInt(r);t<n;)if(0==r%lowprimes[t++])return!1}return o.millerRabin(e)}function bnpMillerRabin(e){var o=this.subtract(BigInteger.ONE),n=o.getLowestSetBit();if(0>=n)return!1;var p=o.shiftRight(n);e=e+1>>1,e>lowprimes.length&&(e=lowprimes.length);for(var r=nbi(),d=0;d<e;++d){r.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var s=r.modPow(p,this);if(0!=s.compareTo(BigInteger.ONE)&&0!=s.compareTo(o)){for(var a=1;a++<n&&0!=s.compareTo(o);)if(s=s.modPowInt(2,this),0==s.compareTo(BigInteger.ONE))return!1;if(0!=s.compareTo(o))return!1}}return!0}BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime,BigInteger.prototype.square=bnSquare,function(t,e,o,r,p,d,s){function a(e){var r,n,p=this,d=e.length,s=0,a=p.i=p.j=p.m=0;for(p.S=[],p.c=[],d||(e=[d++]);s<o;)p.S[s]=s++;for(s=0;s<o;s++)r=p.S[s],a=h(a+r+e[s%d]),n=p.S[a],p.S[s]=n,p.S[a]=r;p.g=function(e){var n=p.S,d=h(p.i+1),s=n[d],a=h(p.j+s),m=n[a];n[d]=m,n[a]=s;for(var l=n[h(s+m)];--e;)d=h(d+1),s=n[d],a=h(a+s),m=n[a],n[d]=m,n[a]=s,l=l*o+n[h(s+m)];return p.i=d,p.j=a,l},p.g(o)}function m(t,e,o,r,n){if(o=[],n=typeof t,e&&"object"==n)for(r in t)if(5>r.indexOf("S"))try{o.push(m(t[r],e-1))}catch(t){}return o.length?o:t+("string"==n?"":"\0")}function l(t,e,o,r){for(t+="",o=0,r=0;r<t.length;r++)e[h(r)]=h((o^=19*e[h(r)])+t.charCodeAt(r));for(r in t="",e)t+=String.fromCharCode(e[r]);return t}function h(t){return t&o-1}e.seedrandom=function(n,h){var c,u=[];return n=l(m(h?[n,t]:arguments.length?n:[new Date().getTime(),t,window],3),u),c=new a(u),l(c.S,t),e.random=function(){for(var t=c.g(r),e=s,a=0;t<p;)t=(t+a)*o,e*=o,a=c.g(1);for(;t>=d;)t/=2,e/=2,a>>>=1;return(t+a)/e},n},s=e.pow(o,r),p=e.pow(2,p),d=2*p,l(e.random(),t)}([],Math,256,6,52);function SeededRandom(){}function SRnextBytes(t){var e;for(e=0;e<t.length;e++)t[e]=Math.floor(256*Math.random())}SeededRandom.prototype.nextBytes=SRnextBytes;function Arcfour(){this.i=0,this.j=0,this.S=[]}function ARC4init(e){var o,r,n;for(o=0;256>o;++o)this.S[o]=o;for(r=0,o=0;256>o;++o)r=255&r+this.S[o]+e[o%e.length],n=this.S[o],this.S[o]=this.S[r],this.S[r]=n;this.i=0,this.j=0}function ARC4next(){var e;return this.i=255&this.i+1,this.j=255&this.j+this.S[this.i],e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[255&e+this.S[this.i]]}Arcfour.prototype.init=ARC4init,Arcfour.prototype.next=ARC4next;function prng_newstate(){return new Arcfour}var rng_state,rng_pool,rng_pptr,rng_psize=256;function rng_seed_int(t){rng_pool[rng_pptr++]^=255&t,rng_pool[rng_pptr++]^=255&t>>8,rng_pool[rng_pptr++]^=255&t>>16,rng_pool[rng_pptr++]^=255&t>>24,rng_pptr>=rng_psize&&(rng_pptr-=rng_psize)}function rng_seed_time(){rng_seed_int(new Date().getTime())}if(null==rng_pool){rng_pool=[],rng_pptr=0;var t;if("Netscape"==navigator.appName&&"5">navigator.appVersion&&window.crypto){var z=window.crypto.random(32);for(t=0;t<z.length;++t)rng_pool[rng_pptr++]=255&z.charCodeAt(t)}for(;rng_pptr<rng_psize;)t=Math.floor(65536*Math.random()),rng_pool[rng_pptr++]=t>>>8,rng_pool[rng_pptr++]=255&t;rng_pptr=0,rng_seed_time()}function rng_get_byte(){if(null==rng_state){for(rng_seed_time(),rng_state=prng_newstate(),rng_state.init(rng_pool),rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr)rng_pool[rng_pptr]=0;rng_pptr=0}return rng_state.next()}function rng_get_bytes(t){var e;for(e=0;e<t.length;++e)t[e]=rng_get_byte()}function SecureRandom(){}SecureRandom.prototype.nextBytes=rng_get_bytes;function SHA256(t){function o(t,e){var o=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(o>>16)<<16|65535&o}function r(t,e){return t>>>e|t<<32-e}function e(t,e){return t>>>e}function n(t,e,o){return t&e^~t&o}function p(t,e,o){return t&e^t&o^e&o}function l(t){return r(t,2)^r(t,13)^r(t,22)}function u(t){return r(t,6)^r(t,11)^r(t,25)}function y(t){return r(t,7)^r(t,18)^e(t,3)}function T(t){return r(t,17)^r(t,19)^e(t,10)}return t=function(t){t=t.replace(/\r\n/g,"\n");for(var e,o="",r=0;r<t.length;r++)e=t.charCodeAt(r),128>e?o+=String.fromCharCode(e):127<e&&2048>e?(o+=String.fromCharCode(192|e>>6),o+=String.fromCharCode(128|63&e)):(o+=String.fromCharCode(224|e>>12),o+=String.fromCharCode(128|63&e>>6),o+=String.fromCharCode(128|63&e));return o}(t),function(t){for(var e="0123456789abcdef",o="",r=0;r<4*t.length;r++)o+=e.charAt(15&t[r>>2]>>8*(3-r%4)+4)+e.charAt(15&t[r>>2]>>8*(3-r%4));return o}(function(t,r){var s,m,S,C,D,x,B,A,E,R,w,O,q=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],I=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],N=Array(64);t[r>>5]|=128<<24-r%32,t[(r+64>>9<<4)+15]=r;for(var E=0;E<t.length;E+=16){s=I[0],m=I[1],S=I[2],C=I[3],D=I[4],x=I[5],B=I[6],A=I[7];for(var R=0;64>R;R++)N[R]=16>R?t[R+E]:o(o(o(T(N[R-2]),N[R-7]),y(N[R-15])),N[R-16]),w=o(o(o(o(A,u(D)),n(D,x,B)),q[R]),N[R]),O=o(l(s),p(s,m,S)),A=B,B=x,x=D,D=o(C,w),C=S,S=m,m=s,s=o(w,O);I[0]=o(s,I[0]),I[1]=o(m,I[1]),I[2]=o(S,I[2]),I[3]=o(C,I[3]),I[4]=o(D,I[4]),I[5]=o(x,I[5]),I[6]=o(B,I[6]),I[7]=o(A,I[7])}return I}(function(t){for(var e=[],o=0;o<8*t.length;o+=8)e[o>>5]|=(t.charCodeAt(o/8)&255)<<24-o%32;return e}(t),8*t.length))}var sha256={hex:function(t){return SHA256(t)}};function SHA1(t){function e(t,e){return t<<e|t>>>32-e}function o(t){var e,o,r="";for(e=7;0<=e;e--)o=15&t>>>4*e,r+=o.toString(16);return r}var r,n,p,d,s,a,m,l,h,c=Array(80),u=1732584193,y=4023233417,g=2562383102,f=271733878,b=3285377520;t=function(t){t=t.replace(/\r\n/g,"\n");for(var e,o="",r=0;r<t.length;r++)e=t.charCodeAt(r),128>e?o+=String.fromCharCode(e):127<e&&2048>e?(o+=String.fromCharCode(192|e>>6),o+=String.fromCharCode(128|63&e)):(o+=String.fromCharCode(224|e>>12),o+=String.fromCharCode(128|63&e>>6),o+=String.fromCharCode(128|63&e));return o}(t);var T=t.length,S=[];for(n=0;n<T-3;n+=4)p=t.charCodeAt(n)<<24|t.charCodeAt(n+1)<<16|t.charCodeAt(n+2)<<8|t.charCodeAt(n+3),S.push(p);switch(T%4){case 0:n=2147483648;break;case 1:n=8388608|t.charCodeAt(T-1)<<24;break;case 2:n=32768|(t.charCodeAt(T-2)<<24|t.charCodeAt(T-1)<<16);break;case 3:n=128|(t.charCodeAt(T-3)<<24|t.charCodeAt(T-2)<<16|t.charCodeAt(T-1)<<8);}for(S.push(n);14!=S.length%16;)S.push(0);for(S.push(T>>>29),S.push(4294967295&T<<3),r=0;r<S.length;r+=16){for(n=0;16>n;n++)c[n]=S[r+n];for(n=16;79>=n;n++)c[n]=e(c[n-3]^c[n-8]^c[n-14]^c[n-16],1);for(d=u,s=y,a=g,m=f,l=b,n=0;19>=n;n++)h=4294967295&e(d,5)+(s&a|~s&m)+l+c[n]+1518500249,l=m,m=a,a=e(s,30),s=d,d=h;for(n=20;39>=n;n++)h=4294967295&e(d,5)+(s^a^m)+l+c[n]+1859775393,l=m,m=a,a=e(s,30),s=d,d=h;for(n=40;59>=n;n++)h=4294967295&e(d,5)+(s&a|s&m|a&m)+l+c[n]+2400959708,l=m,m=a,a=e(s,30),s=d,d=h;for(n=60;79>=n;n++)h=4294967295&e(d,5)+(s^a^m)+l+c[n]+3395469782,l=m,m=a,a=e(s,30),s=d,d=h;u=4294967295&u+d,y=4294967295&y+s,g=4294967295&g+a,f=4294967295&f+m,b=4294967295&b+l}var h=o(u)+o(y)+o(g)+o(f)+o(b);return h.toLowerCase()}var sha1={hex:function(t){return SHA1(t)}},MD5=function(t){function e(t,e){return t<<e|t>>>32-e}function o(t,e){var o,r,n,p,d;return n=2147483648&t,p=2147483648&e,o=1073741824&t,r=1073741824&e,d=(1073741823&t)+(1073741823&e),o&r?2147483648^d^n^p:o|r?1073741824&d?3221225472^d^n^p:1073741824^d^n^p:d^n^p}function r(t,e,o){return t&e|~t&o}function n(t,e,o){return t&o|e&~o}function p(t,e,o){return t^e^o}function m(t,e,o){return e^(t|~o)}function s(t,n,p,m,d,l,s){return t=o(t,o(o(r(n,p,m),d),s)),o(e(t,l),n)}function l(t,r,p,m,d,l,s){return t=o(t,o(o(n(r,p,m),d),s)),o(e(t,l),r)}function h(t,r,n,m,d,l,s){return t=o(t,o(o(p(r,n,m),d),s)),o(e(t,l),r)}function u(t,r,n,p,d,l,s){return t=o(t,o(o(m(r,n,p),d),s)),o(e(t,l),r)}function y(t){for(var e,o=t.length,r=o+8,n=16*((r-r%64)/64+1),p=Array(n-1),d=0,s=0;s<o;)e=(s-s%4)/4,d=8*(s%4),p[e]|=t.charCodeAt(s)<<d,s++;return e=(s-s%4)/4,d=8*(s%4),p[e]|=128<<d,p[n-2]=o<<3,p[n-1]=o>>>29,p}function g(t){var e,o,r="",n="";for(o=0;3>=o;o++)e=255&t>>>8*o,n="0"+e.toString(16),r+=n.substr(n.length-2,2);return r}function f(t){t=t.replace(/\r\n/g,"\n");for(var e,o="",r=0;r<t.length;r++)e=t.charCodeAt(r),128>e?o+=String.fromCharCode(e):127<e&&2048>e?(o+=String.fromCharCode(192|e>>6),o+=String.fromCharCode(128|63&e)):(o+=String.fromCharCode(224|e>>12),o+=String.fromCharCode(128|63&e>>6),o+=String.fromCharCode(128|63&e));return o}var T,S,C,D,B,A,E,R,w,O=[],q=7,I=12,j=17,N=22,P=5,M=9,K=14,V=20,L=4,F=11,Z=16,z=23,W=6,H=10,X=15,U=21;for(t=f(t),O=y(t),A=1732584193,E=4023233417,R=2562383102,w=271733878,T=0;T<O.length;T+=16)S=A,C=E,D=R,B=w,A=s(A,E,R,w,O[T+0],q,3614090360),w=s(w,A,E,R,O[T+1],I,3905402710),R=s(R,w,A,E,O[T+2],j,606105819),E=s(E,R,w,A,O[T+3],N,3250441966),A=s(A,E,R,w,O[T+4],q,4118548399),w=s(w,A,E,R,O[T+5],I,1200080426),R=s(R,w,A,E,O[T+6],j,2821735955),E=s(E,R,w,A,O[T+7],N,4249261313),A=s(A,E,R,w,O[T+8],q,1770035416),w=s(w,A,E,R,O[T+9],I,2336552879),R=s(R,w,A,E,O[T+10],j,4294925233),E=s(E,R,w,A,O[T+11],N,2304563134),A=s(A,E,R,w,O[T+12],q,1804603682),w=s(w,A,E,R,O[T+13],I,4254626195),R=s(R,w,A,E,O[T+14],j,2792965006),E=s(E,R,w,A,O[T+15],N,1236535329),A=l(A,E,R,w,O[T+1],P,4129170786),w=l(w,A,E,R,O[T+6],M,3225465664),R=l(R,w,A,E,O[T+11],K,643717713),E=l(E,R,w,A,O[T+0],V,3921069994),A=l(A,E,R,w,O[T+5],P,3593408605),w=l(w,A,E,R,O[T+10],M,38016083),R=l(R,w,A,E,O[T+15],K,3634488961),E=l(E,R,w,A,O[T+4],V,3889429448),A=l(A,E,R,w,O[T+9],P,568446438),w=l(w,A,E,R,O[T+14],M,3275163606),R=l(R,w,A,E,O[T+3],K,4107603335),E=l(E,R,w,A,O[T+8],V,1163531501),A=l(A,E,R,w,O[T+13],P,2850285829),w=l(w,A,E,R,O[T+2],M,4243563512),R=l(R,w,A,E,O[T+7],K,1735328473),E=l(E,R,w,A,O[T+12],V,2368359562),A=h(A,E,R,w,O[T+5],L,4294588738),w=h(w,A,E,R,O[T+8],F,2272392833),R=h(R,w,A,E,O[T+11],Z,1839030562),E=h(E,R,w,A,O[T+14],z,4259657740),A=h(A,E,R,w,O[T+1],L,2763975236),w=h(w,A,E,R,O[T+4],F,1272893353),R=h(R,w,A,E,O[T+7],Z,4139469664),E=h(E,R,w,A,O[T+10],z,3200236656),A=h(A,E,R,w,O[T+13],L,681279174),w=h(w,A,E,R,O[T+0],F,3936430074),R=h(R,w,A,E,O[T+3],Z,3572445317),E=h(E,R,w,A,O[T+6],z,76029189),A=h(A,E,R,w,O[T+9],L,3654602809),w=h(w,A,E,R,O[T+12],F,3873151461),R=h(R,w,A,E,O[T+15],Z,530742520),E=h(E,R,w,A,O[T+2],z,3299628645),A=u(A,E,R,w,O[T+0],W,4096336452),w=u(w,A,E,R,O[T+7],H,1126891415),R=u(R,w,A,E,O[T+14],X,2878612391),E=u(E,R,w,A,O[T+5],U,4237533241),A=u(A,E,R,w,O[T+12],W,1700485571),w=u(w,A,E,R,O[T+3],H,2399980690),R=u(R,w,A,E,O[T+10],X,4293915773),E=u(E,R,w,A,O[T+1],U,2240044497),A=u(A,E,R,w,O[T+8],W,1873313359),w=u(w,A,E,R,O[T+15],H,4264355552),R=u(R,w,A,E,O[T+6],X,2734768916),E=u(E,R,w,A,O[T+13],U,1309151649),A=u(A,E,R,w,O[T+4],W,4149444226),w=u(w,A,E,R,O[T+11],H,3174756917),R=u(R,w,A,E,O[T+2],X,718787259),E=u(E,R,w,A,O[T+9],U,3951481745),A=o(A,S),E=o(E,C),R=o(R,D),w=o(w,B);var _=g(A)+g(E)+g(R)+g(w);return _.toLowerCase()};function parseBigInt(t,e){return new BigInteger(t,e)}function linebrk(t,e){for(var o="",r=0;r+e<t.length;)o+=t.substring(r,r+e)+"\n",r+=e;return o+t.substring(r,t.length)}function byte2Hex(t){return 16>t?"0"+t.toString(16):t.toString(16)}function pkcs1pad2(t,e){if(e<t.length+11)throw"Message too long for RSA (n="+e+", l="+t.length+")";for(var o,r=[],p=t.length-1;0<=p&&0<e;)o=t.charCodeAt(p--),128>o?r[--e]=o:127<o&&2048>o?(r[--e]=128|63&o,r[--e]=192|o>>6):(r[--e]=128|63&o,r[--e]=128|63&o>>6,r[--e]=224|o>>12);r[--e]=0;for(var d=new SecureRandom,s=[];2<e;){for(s[0]=0;0==s[0];)d.nextBytes(s);r[--e]=s[0]}return r[--e]=2,r[--e]=0,new BigInteger(r)}function RSAKey(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function RSASetPublic(t,e){null!=t&&null!=e&&0<t.length&&0<e.length?(this.n=parseBigInt(t,16),this.e=parseInt(e,16)):alert("Invalid RSA public key")}function RSADoPublic(t){return t.modPowInt(this.e,this.n)}function RSAEncrypt(t){var e=pkcs1pad2(t,this.n.bitLength()+7>>3);if(null==e)return null;var o=this.doPublic(e);if(null==o)return null;var r=o.toString(16);return 0==(1&r.length)?r:"0"+r}RSAKey.prototype.doPublic=RSADoPublic,RSAKey.prototype.setPublic=RSASetPublic,RSAKey.prototype.encrypt=RSAEncrypt;function pkcs1unpad2(t,e){for(var o=t.toByteArray(),r=0;r<o.length&&0==o[r];)++r;if(o.length-r!=e-1||2!=o[r])return null;for(++r;0!=o[r];)if(++r>=o.length)return null;for(var n="";++r<o.length;){var p=255&o[r];128>p?n+=String.fromCharCode(p):191<p&&224>p?(n+=String.fromCharCode((31&p)<<6|63&o[r+1]),++r):(n+=String.fromCharCode((15&p)<<12|(63&o[r+1])<<6|63&o[r+2]),r+=2)}return n}function RSASetPrivate(t,e,o){null!=t&&null!=e&&0<t.length&&0<e.length?(this.n=parseBigInt(t,16),this.e=parseInt(e,16),this.d=parseBigInt(o,16)):alert("Invalid RSA private key")}function RSASetPrivateEx(t,e,o,r,n,p,d,s){null!=t&&null!=e&&0<t.length&&0<e.length?(this.n=parseBigInt(t,16),this.e=parseInt(e,16),this.d=parseBigInt(o,16),this.p=parseBigInt(r,16),this.q=parseBigInt(n,16),this.dmp1=parseBigInt(p,16),this.dmq1=parseBigInt(d,16),this.coeff=parseBigInt(s,16)):alert("Invalid RSA private key")}function RSAGenerate(e,o){var r=new SeededRandom,n=e>>1;this.e=parseInt(o,16);for(var p=new BigInteger(o,16);;){for(;;)if(this.p=new BigInteger(e-n,1,r),0==this.p.subtract(BigInteger.ONE).gcd(p).compareTo(BigInteger.ONE)&&this.p.isProbablePrime(10))break;for(;;)if(this.q=new BigInteger(n,1,r),0==this.q.subtract(BigInteger.ONE).gcd(p).compareTo(BigInteger.ONE)&&this.q.isProbablePrime(10))break;if(0>=this.p.compareTo(this.q)){var d=this.p;this.p=this.q,this.q=d}var t=this.p.subtract(BigInteger.ONE),s=this.q.subtract(BigInteger.ONE),a=t.multiply(s);if(0==a.gcd(p).compareTo(BigInteger.ONE)){this.n=this.p.multiply(this.q),this.d=p.modInverse(a),this.dmp1=this.d.mod(t),this.dmq1=this.d.mod(s),this.coeff=this.q.modInverse(this.p);break}}}function RSADoPrivate(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),o=t.mod(this.q).modPow(this.dmq1,this.q);0>e.compareTo(o);)e=e.add(this.p);return e.subtract(o).multiply(this.coeff).mod(this.p).multiply(this.q).add(o)}function RSADecrypt(t){var e=parseBigInt(t,16),o=this.doPrivate(e);return null==o?null:pkcs1unpad2(o,this.n.bitLength()+7>>3)}RSAKey.prototype.doPrivate=RSADoPrivate,RSAKey.prototype.setPrivate=RSASetPrivate,RSAKey.prototype.setPrivateEx=RSASetPrivateEx,RSAKey.prototype.generate=RSAGenerate,RSAKey.prototype.decrypt=RSADecrypt;var _RSASIGN_DIHEAD=[];_RSASIGN_DIHEAD.sha1="3021300906052b0e03021a05000414",_RSASIGN_DIHEAD.sha256="3031300d060960864801650304020105000420";var _RSASIGN_HASHHEXFUNC=[];_RSASIGN_HASHHEXFUNC.sha1=sha1.hex,_RSASIGN_HASHHEXFUNC.sha256=sha256.hex;function _rsasign_getHexPaddedDigestInfoForString(t,e,o){for(var r=_RSASIGN_HASHHEXFUNC[o],n=r(t),p="0001",d="00"+_RSASIGN_DIHEAD[o]+n,s="",a=e/4-p.length-d.length,m=0;m<a;m+=2)s+="ff";return sPaddedMessageHex=p+s+d,sPaddedMessageHex}function _rsasign_signString(t,e){var o=_rsasign_getHexPaddedDigestInfoForString(t,this.n.bitLength(),e),r=parseBigInt(o,16),n=this.doPrivate(r),p=n.toString(16);return p}function _rsasign_signStringWithSHA1(t){var e=_rsasign_getHexPaddedDigestInfoForString(t,this.n.bitLength(),"sha1"),o=parseBigInt(e,16),r=this.doPrivate(o),n=r.toString(16);return n}function _rsasign_signStringWithSHA256(t){var e=_rsasign_getHexPaddedDigestInfoForString(t,this.n.bitLength(),"sha256"),o=parseBigInt(e,16),r=this.doPrivate(o),n=r.toString(16);return n}function _rsasign_getDecryptSignatureBI(t,e,o){var r=new RSAKey;r.setPublic(e,o);var n=r.doPublic(t);return n}function _rsasign_getHexDigestInfoFromSig(t,e,o){var r=_rsasign_getDecryptSignatureBI(t,e,o),n=r.toString(16).replace(/^1f+00/,"");return n}function _rsasign_getAlgNameAndHashFromHexDisgestInfo(t){for(var e in _RSASIGN_DIHEAD){var o=_RSASIGN_DIHEAD[e],r=o.length;if(t.substring(0,r)==o){var n=[e,t.substring(r)];return n}}return[]}function _rsasign_verifySignatureWithArgs(t,e,o,r){var n=_rsasign_getHexDigestInfoFromSig(e,o,r),p=_rsasign_getAlgNameAndHashFromHexDisgestInfo(n);if(0==p.length)return!1;var d=p[0],s=p[1],a=_RSASIGN_HASHHEXFUNC[d],m=a(t);return s==m}function _rsasign_verifyHexSignatureForMessage(t,e){var o=parseBigInt(t,16),r=_rsasign_verifySignatureWithArgs(e,o,this.n.toString(16),this.e.toString(16));return r}function _rsasign_verifyString(t,e){e=e.replace(/[ \n]+/g,"");var o=parseBigInt(e,16),r=this.doPublic(o),n=r.toString(16).replace(/^1f+00/,""),p=_rsasign_getAlgNameAndHashFromHexDisgestInfo(n);if(0==p.length)return!1;var d=p[0],s=p[1],a=_RSASIGN_HASHHEXFUNC[d],m=a(t);return s==m}RSAKey.prototype.signString=_rsasign_signString,RSAKey.prototype.signStringWithSHA1=_rsasign_signStringWithSHA1,RSAKey.prototype.signStringWithSHA256=_rsasign_signStringWithSHA256,RSAKey.prototype.verifyString=_rsasign_verifyString,RSAKey.prototype.verifyHexSignatureForMessage=_rsasign_verifyHexSignatureForMessage;var aes=function(){var t={};return t.Sbox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],t.ShiftRowTab=[0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11],t.Init=function(){t.Sbox_Inv=Array(256);for(var e=0;256>e;e++)t.Sbox_Inv[t.Sbox[e]]=e;t.ShiftRowTab_Inv=Array(16);for(var e=0;16>e;e++)t.ShiftRowTab_Inv[t.ShiftRowTab[e]]=e;t.xtime=Array(256);for(var e=0;128>e;e++)t.xtime[e]=e<<1,t.xtime[128+e]=27^e<<1},t.Done=function(){delete t.Sbox_Inv,delete t.ShiftRowTab_Inv,delete t.xtime},t.ExpandKey=function(e){var o,r=e.length,n=1;16===r?o=176:24===r?o=208:32===r?o=240:alert("my.ExpandKey: Only key lengths of 16, 24 or 32 bytes allowed!");for(var p,d=r;d<o;d+=4){p=e.slice(d-4,d),0==d%r?(p=[t.Sbox[p[1]]^n,t.Sbox[p[2]],t.Sbox[p[3]],t.Sbox[p[0]]],256<=(n<<=1)&&(n^=283)):24<r&&16==d%r&&(p=[t.Sbox[p[0]],t.Sbox[p[1]],t.Sbox[p[2]],t.Sbox[p[3]]]);for(var s=0;4>s;s++)e[d+s]=e[d+s-r]^p[s]}},t.Encrypt=function(e,o){var r=o.length;t.AddRoundKey(e,o.slice(0,16));for(var n=16;n<r-16;n+=16)t.SubBytes(e,t.Sbox),t.ShiftRows(e,t.ShiftRowTab),t.MixColumns(e),t.AddRoundKey(e,o.slice(n,n+16));t.SubBytes(e,t.Sbox),t.ShiftRows(e,t.ShiftRowTab),t.AddRoundKey(e,o.slice(n,r))},t.Decrypt=function(e,o){var r=o.length;t.AddRoundKey(e,o.slice(r-16,r)),t.ShiftRows(e,t.ShiftRowTab_Inv),t.SubBytes(e,t.Sbox_Inv);for(var n=r-32;16<=n;n-=16)t.AddRoundKey(e,o.slice(n,n+16)),t.MixColumns_Inv(e),t.ShiftRows(e,t.ShiftRowTab_Inv),t.SubBytes(e,t.Sbox_Inv);t.AddRoundKey(e,o.slice(0,16))},t.SubBytes=function(t,e){for(var o=0;16>o;o++)t[o]=e[t[o]]},t.AddRoundKey=function(t,e){for(var o=0;16>o;o++)t[o]^=e[o]},t.ShiftRows=function(t,e){for(var o=[].concat(t),r=0;16>r;r++)t[r]=o[e[r]]},t.MixColumns=function(e){for(var o=0;16>o;o+=4){var r=e[o+0],n=e[o+1],p=e[o+2],d=e[o+3],s=r^n^p^d;e[o+0]^=s^t.xtime[r^n],e[o+1]^=s^t.xtime[n^p],e[o+2]^=s^t.xtime[p^d],e[o+3]^=s^t.xtime[d^r]}},t.MixColumns_Inv=function(e){for(var o=0;16>o;o+=4){var r=e[o+0],n=e[o+1],p=e[o+2],d=e[o+3],s=r^n^p^d,a=t.xtime[s],m=t.xtime[t.xtime[a^r^p]]^s,l=t.xtime[t.xtime[a^n^d]]^s;e[o+0]^=m^t.xtime[r^n],e[o+1]^=l^t.xtime[n^p],e[o+2]^=m^t.xtime[p^d],e[o+3]^=l^t.xtime[d^r]}},t}(),cryptico=function(){var t={};aes.Init();return t.b256to64=function(e){var t,o,p,d="",m=0,h=0,u=e.length;for(p=0;p<u;p++)o=e.charCodeAt(p),0==h?(d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&o>>2),t=(3&o)<<4):1==h?(d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t|15&o>>4),t=(15&o)<<2):2==h&&(d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t|3&o>>6),m+=1,d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&o)),m+=1,h+=1,3==h&&(h=0);return 0<h&&(d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t),m+=1,d+="=",m+=1),1==h&&(d+="="),d},t.b64to256=function(e){var t,o,p="",d=0,m=0,l=e.length;for(o=0;o<l;o++)t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e.charAt(o)),0<=t&&(d&&(p+=String.fromCharCode(m|255&t>>6-d)),d=7&d+2,m=255&t<<d);return p},t.b16to64=function(t){var e,o,r="";for(1==t.length%2&&(t="0"+t),e=0;e+3<=t.length;e+=3)o=parseInt(t.substring(e,e+3),16),r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(o>>6)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&o);for(e+1==t.length?(o=parseInt(t.substring(e,e+1),16),r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(o<<2)):e+2==t.length&&(o=parseInt(t.substring(e,e+2),16),r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(o>>2)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((3&o)<<4));0<(3&r.length);)r+="=";return r},t.b64to16=function(t){var e,o,r="",n=0;for(e=0;e<t.length&&"="!=t.charAt(e);++e)v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(t.charAt(e)),0>v||(0==n?(r+=int2char(v>>2),o=3&v,n=1):1==n?(r+=int2char(o<<2|v>>4),o=15&v,n=2):2==n?(r+=int2char(o),r+=int2char(v>>2),o=3&v,n=3):(r+=int2char(o<<2|v>>4),r+=int2char(15&v),n=0));return 1==n&&(r+=int2char(o<<2)),r},t.string2bytes=function(t){for(var e=[],o=0;o<t.length;o++)e.push(t.charCodeAt(o));return e},t.bytes2string=function(t){for(var e="",o=0;o<t.length;o++)e+=String.fromCharCode(t[o]);return e},t.blockXOR=function(t,e){for(var o=Array(16),r=0;16>r;r++)o[r]=t[r]^e[r];return o},t.blockIV=function(){var t=new SecureRandom,e=Array(16);return t.nextBytes(e),e},t.pad16=function(t){var e=t.slice(0),o=(16-t.length%16)%16;for(i=t.length;i<t.length+o;i++)e.push(0);return e},t.depad=function(t){for(var e=t.slice(0);0==e[e.length-1];)e=e.slice(0,e.length-1);return e},t.encryptAESCBC=function(e,o){var r=o.slice(0);aes.ExpandKey(r);var n=t.string2bytes(e);n=t.pad16(n);for(var p=t.blockIV(),d=0;d<n.length/16;d++){var s=n.slice(16*d,16*d+16),a=p.slice(16*d,16*d+16);s=t.blockXOR(a,s),aes.Encrypt(s,r),p=p.concat(s)}var m=t.bytes2string(p);return t.b256to64(m)},t.decryptAESCBC=function(e,o){var r=o.slice(0);aes.ExpandKey(r);for(var e=t.b64to256(e),n=t.string2bytes(e),p=[],d=1;d<n.length/16;d++){var s=n.slice(16*d,16*d+16),a=n.slice(16*(d-1),16*(d-1)+16);aes.Decrypt(s,r),s=t.blockXOR(a,s),p=p.concat(s)}return p=t.depad(p),t.bytes2string(p)},t.wrap60=function(t){for(var e="",o=0;o<t.length;o++)0==o%60&&0!=o&&(e+="\n"),e+=t[o];return e},t.generateAESKey=function(){var t=Array(32),e=new SecureRandom;return e.nextBytes(t),t},t.generateRSAKey=function(t,e){Math.seedrandom(sha256.hex(t));var o=new RSAKey;return o.generate(e,"03"),o},t.publicKeyString=function(e){return pubkey=t.b16to64(e.n.toString(16)),pubkey},t.publicKeyID=function(t){return MD5(t)},t.publicKeyFromString=function(e){var o=t.b64to16(e.split("|")[0]),r=new RSAKey;return r.setPublic(o,"03"),r},t.encrypt=function(e,o,r){var n="",p=t.generateAESKey();try{var d=t.publicKeyFromString(o);n+=t.b16to64(d.encrypt(t.bytes2string(p)))+"?"}catch(t){return{status:"Invalid public key"}}return r&&(signString=cryptico.b16to64(r.signString(e,"sha256")),e+="::52cee64bb3a38f6403386519a39ac91c::",e+=cryptico.publicKeyString(r),e+="::52cee64bb3a38f6403386519a39ac91c::",e+=signString),n+=t.encryptAESCBC(e,p),{status:"success",cipher:n}},t.decrypt=function(e,o){var r=e.split("?"),n=o.decrypt(t.b64to16(r[0]));if(null==n)return{status:"failure"};n=t.string2bytes(n);var p=t.decryptAESCBC(r[1],n).split("::52cee64bb3a38f6403386519a39ac91c::");if(3==p.length){var d=t.publicKeyFromString(p[1]),s=t.b64to16(p[2]);return d.verifyString(p[0],s)?{status:"success",plaintext:p[0],signature:"verified",publicKeyString:t.publicKeyString(d)}:{status:"success",plaintext:p[0],signature:"forged",publicKeyString:t.publicKeyString(d)}}return{status:"success",plaintext:p[0],signature:"unsigned"}},t}();